<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JSON数据</title>

    <script type="text/javascript">

        /**************************** JSON定义 ****************************/
        //JSON是一种超轻量级的交换数据格式


        /*********************** JSON数据格式 ************************/
        /*
        * 必须使用UTF-8编码, 并且每个键值对都要用双引号(必须是双引号)
        *
        * number
        *
        * boolean
        *
        * string
        *
        * null
        *
        * array
        *
        * object
        * */
        /************************JSON序列化(将对象转换成JSON)************************/
        var xiaoming = {
            name:"xiaoming",
            age : 20,
            married: true,
            grade:null,
            skills:['Java','JS','Python']
        };

        var xiaomingJSON = window.JSON.stringify(xiaoming);

        window.alert(typeof xiaomingJSON==='string'); //true
        //JSON就是一种格式特殊的字符串

        window.alert(xiaomingJSON);

        function convert(key,value){
            if(typeof value==='string')
            {
                return value.toUpperCase();
            }
            return value
        }
        window.alert(window.JSON.stringify(xiaoming,convert,' '));
        //可以传递一个函数, 对JSON字符串进行一定的处理

        //如果要进一步控制JS对象的JSON序列化, 可以给对象定义一个toJSON()方法
        //这个方法的返回值类型一定要是对象
        xiaoming.toJSON = function(){
            return {
                'name' : this.name,
                'age' : this.age
            };
        }
        window.alert(window.JSON.stringify(xiaoming));
        //JSON.stringify(JSObject),放在在运行的时候会首先检测JSObject对象是否具有toJSON(),
        //如果没有就直接对本对象进行序列化
        //如果有的话, 就对toJSON()方法返回的对象进行序列化

        var weather = {"query":{"count":1,"created":"2015-08-17T08:24:26Z","lang":"zh-cn","results":{"channel":{"title":"Yahoo! Weather - Beijing, CN","link":"http://us.rd.yahoo.com/dailynews/rss/weather/Beijing__CN/*http://weather.yahoo.com/forecast/CHXX0008_f.html","description":"Yahoo! Weather for Beijing, CN","language":"en-us","lastBuildDate":"Mon, 17 Aug 2015 1:59 pm CST","ttl":"60","location":{"city":"Beijing","country":"China","region":""},"units":{"distance":"mi","pressure":"in","speed":"mph","temperature":"F"},"wind":{"chill":"91","direction":"180","speed":"7"},"atmosphere":{"humidity":"45","pressure":"29.59","rising":"0","visibility":"3.73"},"astronomy":{"sunrise":"5:27 am","sunset":"7:08 pm"},"image":{"title":"Yahoo! Weather","width":"142","height":"18","link":"http://weather.yahoo.com","url":"http://l.yimg.com/a/i/brand/purplelogo//uh/us/news-wea.gif"},"item":{"title":"Conditions for Beijing, CN at 1:59 pm CST","lat":"39.91","long":"116.39","link":"http://us.rd.yahoo.com/dailynews/rss/weather/Beijing__CN/*http://weather.yahoo.com/forecast/CHXX0008_f.html","pubDate":"Mon, 17 Aug 2015 1:59 pm CST","condition":{"code":"21","date":"Mon, 17 Aug 2015 1:59 pm CST","temp":"91","text":"Haze"},"description":"\n<img src=\"http://l.yimg.com/a/i/us/we/52/21.gif\"/><br />\n<b>Current Conditions:</b><br />\nHaze, 91 F<BR />\n<BR /><b>Forecast:</b><BR />\nMon - Thunderstorms. High: 90 Low: 69<br />\nTue - PM Thunderstorms. High: 90 Low: 69<br />\nWed - AM Thunderstorms. High: 82 Low: 65<br />\nThu - Partly Cloudy. High: 91 Low: 67<br />\nFri - Mostly Sunny. High: 91 Low: 68<br />\n<br />\n<a href=\"http://us.rd.yahoo.com/dailynews/rss/weather/Beijing__CN/*http://weather.yahoo.com/forecast/CHXX0008_f.html\">Full Forecast at Yahoo! Weather</a><BR/><BR/>\n(provided by <a href=\"http://www.weather.com\" >The Weather Channel</a>)<br/>\n","forecast":[{"code":"4","date":"17 Aug 2015","day":"Mon","high":"90","low":"69","text":"Thunderstorms"},{"code":"38","date":"18 Aug 2015","day":"Tue","high":"90","low":"69","text":"PM Thunderstorms"},{"code":"38","date":"19 Aug 2015","day":"Wed","high":"82","low":"65","text":"AM Thunderstorms"},{"code":"30","date":"20 Aug 2015","day":"Thu","high":"91","low":"67","text":"Partly Cloudy"},{"code":"34","date":"21 Aug 2015","day":"Fri","high":"91","low":"68","text":"Mostly Sunny"}],"guid":{"isPermaLink":"false","content":"CHXX0008_2015_08_21_7_00_CST"}}}}}};
        var wO = window.JSON.stringify(weather,null,' ');

        window.alert(wO);

        /*********************** JSON 反序列化 (JSON串转换成JS对象) **********************/
        var str = '{"name":"xiaoming"}';

        var obj  = JSON.parse(str);

        window.alert(obj.name);

        for(var x in obj)
        {
            alert(obj[x]);
        }

        var JSONString = '{' +
                '"name":"xiaoming",' +
                '"age":"20",' +
                '"skills":["Java","JS"]}';

        var obj2 = JSON.parse(JSONString);

        for(var xx in obj2)
        {
            alert(obj2[xx]);
        }






    </script>
</head>
<body>

</body>
</html>